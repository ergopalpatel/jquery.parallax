/**************************************************\
|* Script Author: Djordje Jocic                   *|
|* Script Year: 2015                              *|
|* Script Version: 1.0.0                          *|
|* Script License: MIT License (MIT)              *|
|* ============================================== *|
|* Official Website: http://www.djordjejocic.com/ *|
|* ============================================== *|
|* Permission is hereby granted, free of charge,  *|
|* to any person obtaining a copy of this         *|
|* software and associated documentation files    *|
|* (the "Software"), to deal in the Software      *|
|* without restriction, including without         *|
|* limitation the rights to use, copy, modify,    *|
|* merge, publish, distribute, sublicense, and/or *|
|* sell copies of the Software, and to permit     *|
|* persons to whom the Software is furnished to   *|
|* do so, subject to the following conditions:    *|
|* ---------------------------------------------- *|
|* The above copyright notice and this permission *|
|* notice shall be included in all copies or      *|
|* substantial portions of the Software.          *|
|* ---------------------------------------------- *|
|* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT      *|
|* WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,      *|
|* INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF *|
|* MERCHANTABILITY, FITNESS FOR A PARTICULAR      *|
|* PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL *|
|* THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR *|
|* ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER *|
|* IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,   *|
|* RISING FROM, OUT OF OR IN CONNECTION WITH THE  *|
|* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE   *|
|* SOFTWARE.                                      *|
\**************************************************/

function ParallaxRenderer(){this.render=function(a,e){if(e.parallaxInit){var t=this.calculateParallaxRatio(a,e.settings.start,e.settings.end);a-=e.offset().top;var r=-Math.floor(t*e.settings.offset),l=this.parsePosition(e.css("background-position"));l.left+="px",l.top=r+"px",e.css("background-position",l.left+" "+l.top)}},this.parseLocation=function(a){return a.trim().replace(/^((url\()+(`|'|"))/,"").replace(/((`|'|")+(\)))$/,"")},this.parsePosition=function(a){var e={left:0,top:0};return a=a.replace(/[^0-9\s]/g,"").trim().split(" ",2),e.left=a[0],e.top=a[1],e},this.clamp=function(a,e,t){return e>a?e:a>t?t:a},this.calculateOffset=function(a,e){if(e.height>=a.height)return 0;var t=e.width()/a.width,r=Math.floor(a.height*t);return r-e.height()},this.calculateParallaxRatio=function(a,e,t){return e=0>e?0:e,a-=e,t-=e,a/t}}!function(a){a.fn.parallaxCore={scrollDefault:[],scrollManual:[],countDefault:0,countManual:0,refreshTimeout:null,renderer:new ParallaxRenderer},a.fn.parallax=function(e){var t=a(this);if("undefined"==typeof t.parallaxInit){var r=new Image,l=a("<div />",{"class":"parallax-preloader",style:"display: none;"});"undefined"==typeof e&&(e={image:null,height:null,billboard:!0,scroll:"default"}),t.parallaxInit=!0,r.onload=function(){l.remove(),e.offset=a.fn.parallaxCore.renderer.calculateOffset(r,t),t.settings=e,"default"===e.scroll?(a.fn.parallaxCore.scrollDefault.push(t),a.fn.parallaxCore.countDefault++):"manual"===e.scroll&&(a.fn.parallaxCore.scrollManual.push(t),a.fn.parallaxCore.countManual++)},l.appendTo(t),setTimeout(function(){l.show()},1e3),null==e.image?r.src=a.fn.parallaxCore.renderer.parseLocation(t.css("background-image")):(t.css({"background-image":"url("+e.image+")","background-size":"100% auto"}),r.src=e.image),null==e.height?e.height=t.height():t.height(e.height),e.start=t.offset().top-a(window).height(),e.end=t.height()+t.offset().top}},a.fn.parallaxScroll=function(e){var t=a(this);e>=t.settings.start&&e<=t.settings.end&&a.fn.parallaxCore.renderer.render(e,t)},a.fn.parallaxRefresh=function(a){},a(document).scroll(function(){for(var e=a(this).scrollTop(),t=null,r=0;r<a.fn.parallaxCore.countDefault;r++)t=a.fn.parallaxCore.scrollDefault[r],e>=t.settings.start&&e<=t.settings.end&&a.fn.parallaxCore.renderer.render(e,t)}),a(window).resize(function(){null==a.fn.parallaxCore.refreshTimeout&&(a.fn.parallaxCore.refreshTimeout=setTimeout(function(){for(var e=null,t=0;t<a.fn.parallaxCore.countDefault;t++)e=a.fn.parallaxCore.scrollDefault[t],e.settings.start=e.offset().top-a(window).height();for(var t=0;t<a.fn.parallaxCore.countManual;t++)e=a.fn.parallaxCore.scrollManual[t],e.settings.start=e.offset().top-a(window).height();a.fn.parallaxCore.refreshTimeout=null},1e3))})}(jQuery);
